import{s as y,j as e}from"./index-CTmt-P1O.js";import{r as n}from"./router-DmZmTQD2.js";import{H as l,K as Y,N as z,O as I,Q as k,S as w,a as O}from"./icons-C3RlEb-g.js";import"./react-vendor-ZjeaK7N3.js";import"./supabase-C8HnRnw-.js";function $(){const[h,i]=n.useState([]),[N,f]=n.useState(!0),[c,u]=n.useState(!1),[a,o]=n.useState({studentName:"",message:"",contributorName:"",isAnonymous:!1}),[b,v]=n.useState(!1),[x,_]=n.useState([]),[p,T]=n.useState("all");n.useEffect(()=>{S(),C()},[]);const S=async()=>{f(!0);try{const{data:s,error:t}=await y.from("thank_you_notes").select("*").order("created_at",{ascending:!1});t?(console.log("Thank you notes table may not exist yet"),i(d)):i(s||[])}catch(s){console.error("Error:",s),i(d)}finally{f(!1)}},C=async()=>{try{const{data:s}=await y.from("notes").select("author");if(s){const t=[...new Set(s.map(m=>m.author))];_(t)}}catch(s){console.error("Error fetching contributors:",s)}},A=async s=>{s.preventDefault(),v(!0);try{const t={student_name:a.isAnonymous?"Anonymous Student":a.studentName,message:a.message,contributor_name:a.contributorName||"All Contributors",created_at:new Date().toISOString()},{error:m}=await y.from("thank_you_notes").insert([t]);m?(console.log("Could not save to database, adding to local state"),i(j=>[{id:Date.now(),...t},...j])):S(),o({studentName:"",message:"",contributorName:"",isAnonymous:!1}),u(!1),alert("Thank you note sent! ðŸ’")}catch(t){console.error("Error:",t),alert("Your message has been recorded! ðŸ’")}finally{v(!1)}},D=s=>{const t=new Date(s),j=new Date-t,r=Math.floor(j/864e5);return r===0?"Today":r===1?"Yesterday":r<7?`${r} days ago`:r<30?`${Math.floor(r/7)} weeks ago`:`${Math.floor(r/30)} months ago`},g=p==="all"?h:h.filter(s=>s.contributor_name===p),d=[{id:1,student_name:"Kasun from Ratnapura",message:"I lost all my A/L notes in the floods. Thanks to the contributors here, I found everything I needed for my Chemistry exam. You saved my future! ðŸ™",contributor_name:"All Contributors",created_at:new Date(Date.now()-864e5*2).toISOString()},{id:2,student_name:"Nethmi",message:"The maths formulas revision cards helped me so much! I passed my O/L with flying colors. Thank you from the bottom of my heart â¤ï¸",contributor_name:"Anonymous",created_at:new Date(Date.now()-864e5*5).toISOString()},{id:3,student_name:"Anonymous Student",message:"My family lost everything in the landslide. Getting access to these study materials means I can still continue my education. God bless you all!",contributor_name:"All Contributors",created_at:new Date(Date.now()-864e5*10).toISOString()},{id:4,student_name:"Sahan from Kegalle",message:"The physics past papers were exactly what I needed! Thank you for uploading them. I scored 78 marks! ðŸŽ‰",contributor_name:"Anonymous",created_at:new Date(Date.now()-864e5*15).toISOString()}];return e.jsxs("div",{className:"container py-8",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{className:"page-header-top",children:[e.jsxs("div",{className:"header-title-row",children:[e.jsx(l,{size:28,className:"header-icon"}),e.jsx("h1",{className:"text-3xl",children:"Thank You Wall"})]}),e.jsxs("button",{className:"btn-primary",onClick:()=>u(!c),children:[c?e.jsx(Y,{size:18}):e.jsx(l,{size:18}),c?"Close":"Send Thanks"]})]}),e.jsx("p",{className:"page-description",children:"A space for students to express gratitude to the amazing people who share their study materials. Your contributions are changing lives!"})]}),c&&e.jsx("div",{className:"thank-you-form-container",children:e.jsxs("form",{onSubmit:A,className:"thank-you-form",children:[e.jsxs("h3",{children:[e.jsx(z,{size:20})," Write a Thank You Note"]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Your Name"}),e.jsx("input",{type:"text",value:a.studentName,onChange:s=>o({...a,studentName:s.target.value}),placeholder:"e.g., Kasun from Ratnapura",disabled:a.isAnonymous})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:a.isAnonymous,onChange:s=>o({...a,isAnonymous:s.target.checked})}),"Stay Anonymous"]})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Thank (Optional)"}),e.jsxs("select",{value:a.contributorName,onChange:s=>o({...a,contributorName:s.target.value}),children:[e.jsx("option",{value:"",children:"All Contributors"}),x.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Your Message *"}),e.jsx("textarea",{value:a.message,onChange:s=>o({...a,message:s.target.value}),placeholder:"Share how the materials helped you...",rows:4,required:!0})]}),e.jsxs("button",{type:"submit",className:"btn-primary",disabled:b,children:[e.jsx(I,{size:18}),b?"Sending...":"Send Thank You"]})]})}),e.jsxs("div",{className:"thank-you-stats",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx(l,{size:24,className:"text-danger"}),e.jsx("span",{className:"stat-number",children:h.length}),e.jsx("span",{className:"stat-label",children:"Thank You Notes"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx(k,{size:24,className:"text-primary"}),e.jsx("span",{className:"stat-number",children:x.length}),e.jsx("span",{className:"stat-label",children:"Contributors"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx(w,{size:24,className:"text-warning"}),e.jsx("span",{className:"stat-number",children:"âˆž"}),e.jsx("span",{className:"stat-label",children:"Lives Touched"})]})]}),e.jsxs("div",{className:"filter-bar",children:[e.jsx("span",{children:"Filter by:"}),e.jsxs("select",{value:p,onChange:s=>T(s.target.value),children:[e.jsx("option",{value:"all",children:"All Notes"}),x.map(s=>e.jsxs("option",{value:s,children:["To: ",s]},s))]})]}),N?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Loading messages..."})}):e.jsx("div",{className:"thank-you-grid",children:(g.length>0?g:d).map((s,t)=>e.jsxs("div",{className:`thank-you-card color-${t%5}`,children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"avatar",children:e.jsx(k,{size:20})}),e.jsxs("div",{className:"sender-info",children:[e.jsx("span",{className:"sender-name",children:s.student_name}),e.jsxs("span",{className:"send-date",children:[e.jsx(O,{size:12}),D(s.created_at)]})]})]}),e.jsx("div",{className:"card-body",children:e.jsx("p",{className:"message",children:s.message})}),e.jsx("div",{className:"card-footer",children:e.jsxs("span",{className:"to-label",children:[e.jsx(l,{size:14,className:"text-danger"}),"To: ",s.contributor_name]})})]},s.id))}),!N&&g.length===0&&d.length===0&&e.jsxs("div",{className:"empty-state",children:[e.jsx(l,{size:48,className:"text-gray-300"}),e.jsx("h3",{children:"No Thank You Notes Yet"}),e.jsx("p",{children:"Be the first to express your gratitude!"}),e.jsx("button",{className:"btn-primary",onClick:()=>u(!0),children:"Send a Thank You"})]}),e.jsx("div",{className:"thank-you-cta",children:e.jsxs("div",{className:"cta-content",children:[e.jsxs("h3",{children:[e.jsx(w,{size:20})," Spread the Love"]}),e.jsx("p",{children:"Did someone's materials help you? Let them know! A simple thank you can motivate more people to share."})]})})]})}export{$ as default};
